<h1>Machine Learning API を起動する</h1>
<h2>概要</h2>
<p>このラボでは、Datalab から Machine Learning API を起動して使用します。</p>
<h3><strong>学習内容</strong></h3>
<p>このラボでは、Python から ML API を呼び出して結果を使用する方法を学びます。</p>
<h2>はじめに</h2>
<p>このラボでは、Datalab から ML API を呼び出して代表的なタスクを実行します。</p>
<ul>
<li>
<p>Vision API を用いて画像内のテキストを読み取る</p>
</li>
<li>
<p>読み取ったテキストを Translate API で英語に翻訳する</p>
</li>
<li>
<p>Natural Language API で代表的な引用句の背景にある感情を捉える</p>
</li>
<li>
<p>Speech API で音声ファイルを文字に書き出す</p>
</li>
</ul>
<h2>設定</h2>
<fragment path="/fragments/cloudshell"></fragment>
<h2>タスク 1: Cloud Datalab を起動する</h2>
<p>Cloud Datalab を起動するには:</p>
<ol>
<li>
<p>Cloud Shell で次のように入力します。</p>
</li>
</ol>
<pre><code class="language-bash">gcloud compute zones list
</code></pre>
<ol start="2">
<li>
<p>地理的に近いリージョンのゾーンを選択します。</p>
</li>
<li>
<p>Cloud Shell で次のように入力します。</p>
</li>
</ol>
<pre><code class="language-bash">datalab create bdmlvm --zone &lt;ZONE&gt;
</code></pre>
<p>Datalab が起動するまでに約 5 分かかります。</p>
<p><code>注: この手順ではプロンプトに沿って操作します。</code></p>
<h2>タスク 2: Cloud Datalab にノートブックをチェックアウトする</h2>
<p>必要に応じて、Datalab の起動が終了するまで待ちます。Datalab が使用できる状態になると、「ウェブでプレビュー」を促すメッセージが表示されます。</p>
<ol>
<li>
<p>Cloud Shell リボンの右上にある [<strong>ウェブでプレビュー</strong>] アイコンをクリックします。[<strong>ポートの変更</strong>] をクリックします。[<strong>プレビュー ポートの変更</strong>] ダイアログ ボックスを使用してポート <strong>8081</strong> に切り替え、[<strong>変更してプレビュー</strong>] をクリックします。</p>
<p><img src="img/ChangePort.png" alt="ChangePort.png"></p>
<p><img src="img/ChangePreviewPort.png" alt="ChangePreviewPort.png"></p>
<p>注: datalab コマンドがアクティブな間は、Datalab インスタンスへの接続は開いたままになります。datalab コマンドの実行に使用している Cloud Shell がクローズされるかまたは中断されると、Cloud Datalab VM への接続が切断されます。その場合、新しい Cloud Shell でコマンド「<code>datalab connect bdmlvm</code>」を使用すると再接続できる可能性があります。</p>
</li>
<li>
<p><strong>Datalab</strong> の右上のリボンにある <strong>[Open ungit]</strong> アイコンをクリックします。</p>
<p><img src="img/fc5c4f63c40f83f.png" alt="fc5c4f63c40f83f.png"></p>
</li>
<li>
<p>[Ungit] ウィンドウで、<strong>/content/datalab/notebooks</strong> というテキストを選択します。このテキストから <strong>notebooks</strong> を削除して <strong>/content/datalab</strong> にし、<strong>Enter</strong> キーを押します。</p>
<p><img src="img/dbeb32393b0874e4.png" alt="dbeb32393b0874e4.png"></p>
</li>
<li>
<p>表示されるパネルの [<strong>Clone from</strong>] に、GitHub リポジトリとして次の文字列を入力します。</p>
<pre><code class="language-bash">https://github.com/GoogleCloudPlatform/training-data-analyst
</code></pre>
</li>
<li>
<p>[<strong>Clone Repository</strong>] をクリックします。</p>
</li>
</ol>
<h2>タスク 3: API キーを取得する</h2>
<p>API キーを取得するには:</p>
<ol>
<li>
<p>GCP Console の[<strong>ナビゲーション メニュー</strong>]（<img alt="8ab244f9cffa6198.png" src="img/mainmenu.png">）で、[<strong>API とサービス</strong>] &gt; [<strong>ライブラリ</strong>] をクリックします。</p>
</li>
<li>
<p>検索ボックスに「<strong>vision</strong>」と入力して、Google が公開している <strong>Cloud Vision API</strong> を確認し、ハイパーリンクをクリックします。</p>
</li>
<li>
<p>必要に応じて [<strong>有効にする</strong>] をクリックします。</p>
</li>
<li>
<p>同様の手順で、Google が公開している <strong>Cloud Translation API</strong>、<strong>Cloud Speech API</strong>、<strong>Cloud Natural Language API</strong> を有効にします。</p>
</li>
<li>
<p>GCP Console メニューで [<strong>API とサービス</strong>] を選択し、[<strong>認証情報</strong>] を選択します。</p>
</li>
<li>
<p>API キーがない場合は、[<strong>認証情報を作成</strong>] ボタンをクリックして [<strong>API キー</strong>] を選択します。作成されたら、API キーをコピーしてから [<strong>閉じる</strong>] をクリックします。この API キーは、後でノートブックで必要になります。</p>
</li>
</ol>
<h2>タスク 4: Datalab から Machine Learning API を呼び出す</h2>
<ol>
<li>
<p>Datalab ブラウザに戻り、<strong>[training-data-analyst] &gt; [CPB100] &gt; [lab4c] &gt; [mlapis.ipynb]</strong> に移動します。</p>
</li>
<li>
<p>コメントを読み、[<strong>Clear | Clear all Cells</strong>] をクリックし、セルに入力された Python スニペットを順番に実行します（<strong>Shift+Enter</strong> キーを使用するとコードを 1 つずつ実行できます）。最初の Python セルに API キーを必ず挿入します。</p>
</li>
</ol>
<fragment path="/fragments/endqwiklab"></fragment>
<h5>マニュアルの最終更新日: 2018 年 10 月 10 日</h5>
<h5>ラボの最終テスト日: 2018 年 10 月 10 日</h5> 
<fragment path="/fragments/copyright"></fragment>
