<h1>BigQuery を使用した ML データセットの作成</h1>
<h2>概要</h2>
<p>このラボでは、Datalab から BigQuery を使用して Pandas データフレームを作成します。このデータフレームがタクシーの需要予測のトレーニング データになります。</p>
<h3><strong>学習内容</strong></h3>
<p>このラボの内容:</p>
<ul>
<li>
<p>BigQuery と Datalab を使用してデータを調べて可視化する</p>
</li>
<li>
<p>TensorFlow を使った機械学習のトレーニング データセットとして使用する Pandas データフレームを構築する</p>
</li>
</ul>
<h2>はじめに</h2>
<p>このラボと次のラボでは、機械学習を使用して需要予測システムを構築します。TensorFlow を使用して、毎日のタクシーの需要を予測します。そのためにはまず、タクシーの需要に影響を与える要素（「入力特徴」）と過去の実際の需要（「ターゲット」）で構成されるトレーニング データセットが必要です。このデータを使用してニューラル ネットワークをトレーニングすると、特徴を入力データとして将来の需要を予測できるようになります。</p>
<p>このラボでは、Datalab の BigQuery を使用してデータセットを構築します。このデータセットは次のラボで機械学習に使用します。</p>
<h2>設定</h2>
<fragment path="/fragments/cloudshell"></fragment>
<h2>タスク 1: Cloud Datalab を起動する</h2>
<p>Cloud Datalab を起動するには:</p>
<ol>
<li>
<p><strong>Cloud Shell</strong> で次のように入力します。</p>
<pre><code class="language-bash">datalab create bdmlvm --zone us-central1-a
</code></pre>
</li>
</ol>
<p>Datalab が起動するまでに約 5 分かかります。</p>
<p><code><strong>注</strong>: このプロセスではプロンプトに従って操作します。</code></p>
<p>Datalab の操作に慣れていない場合には、以下に示す Datalab の主な機能についての図付き早見表をご利用ください。</p>
<p><img src="img/Working-with-Datalab-Graphic-JA.png" alt="Datalabとの作業"></p>
<h2>タスク 2: Cloud Datalab にノートブックをチェックアウトする</h2>
<p><strong>注</strong>: 必要に応じて、Datalab の起動が終了するまで待ちます。Datalab が使用できる状態になると、「ウェブでプレビュー」を促すメッセージが表示されます。</p>
<ol>
<li>
<p>Cloud Shell リボンの右上にある [<strong>ウェブでプレビュー</strong>] アイコンをクリックします。[<strong>ポートの変更</strong>] をクリックします。[<strong>プレビュー ポートの変更</strong>] ダイアログ ボックスを使用してポート <strong>8081</strong> に切り替え、[<strong>変更してプレビュー</strong>] をクリックします。</p>
<p><img src="img/ChangePort.png" alt="ChangePort.png"></p>
<p><img src="img/ChangePreviewPort.png" alt="ChangePreviewPort.png"></p>
<p><strong>注</strong>: datalab コマンドがアクティブな間は、Datalab インスタンスへの接続は開いたままになります。datalab コマンドの実行に使用している Cloud Shell がクローズされるかまたは中断されると、Cloud Datalab VM への接続が切断されます。その場合、新しい Cloud Shell でコマンド「<code>datalab connect bdmlvm</code>」を使用すると再接続できる可能性があります。</p>
</li>
<li>
<p><strong>Datalab</strong> の右上のリボンにある <strong>[Open ungit]</strong> アイコンをクリックします。</p>
<p><img src="img/fc5c4f63c40f83f.png" alt="fc5c4f63c40f83f.png"></p>
</li>
<li>
<p>[Ungit] ウィンドウで、<strong>/content/datalab/notebooks</strong> というテキストを選択します。このテキストから <strong>notebooks</strong> を削除して <strong>/content/datalab</strong> にし、<strong>Enter</strong> キーを押します。</p>
<p><img src="img/dbeb32393b0874e4.png" alt="dbeb32393b0874e4.png"></p>
</li>
<li>
<p>表示されるパネルの [<strong>Clone from</strong>] に、GitHub リポジトリとして次の文字列を入力します。</p>
<pre><code class="language-bash">https://github.com/GoogleCloudPlatform/training-data-analyst
</code></pre>
</li>
<li>
<p>[<strong>Clone repository</strong>] をクリックします。</p>
</li>
</ol>
<h2>タスク 3: Datalab ノートブックを開く</h2>
<ol>
<li>
<p>Datalab ブラウザで <strong>[training-data-analyst] &gt; [CPB100] &gt; [lab4a] &gt; [demandforecast.ipynb]</strong> に移動します。</p>
</li>
<li>
<p>コメントを読み、[<strong>Clear | Clear all Cells</strong>] をクリックし、セルに入力された Python スニペットを順番に実行します（<strong>Shift+Enter</strong> キーを使用するとコードを 1 つずつ実行できます）。</p>
</li>
<li>
<p>「<strong>Machine Learning with Tensorflow</strong>」のセクションに達したらそれ以上進めないでください。このセクションからは次のラボになります。</p>
</li>
</ol>
<fragment path="/fragments/endqwiklab"></fragment>
<h5>マニュアルの最終更新日: 2018 年 10 月 9 日</h5>
<h5>ラボの最終テスト日: 2018 年 10 月 9 日</h5>
<fragment path="/fragments/copyright"></fragment>
